<!-- Generated by SpecStory -->

# ç”ŸæˆåŠ¨æ€æ¼”ç¤ºdemoé¡µé¢ (2025-06-09 12:30:43)

_**User**_

ä½ éµå¾ªæ–‡æ¡£è¦æ±‚ï¼Œç”Ÿæˆdemoé¡µé¢ï¼Œä½¿ç”¨html/css/jsæ¨¡å¼ï¼Œæ”¾åˆ°CJ_Mé‡Œé¢ï¼Œæ³¨æ„è¿™æ˜¯æ¼”ç¤ºdemoï¼Œè¦æ±‚æ˜¯åŠ¨æ€çš„

---

_**Assistant**_



---

å¥½çš„ï¼Œæˆ‘ç†è§£äº†æ‚¨çš„éœ€æ±‚ã€‚æˆ‘å°†æ ¹æ®æ‚¨æä¾›çš„äº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰ï¼Œåœ¨ `CJ_M` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªçº¯å‰ç«¯çš„ã€åŠ¨æ€çš„12345çƒ­çº¿AIè¯­éŸ³åŠ©æ‰‹æ¼”ç¤ºDemoé¡µé¢ã€‚

è¿™ä¸ªDemoå°†åŒ…å« `index.html` (é¡µé¢ç»“æ„), `style.css` (é¡µé¢æ ·å¼), å’Œ `script.js` (æ ¸å¿ƒäº¤äº’é€»è¾‘å’ŒåŠ¨ç”»)ã€‚æˆ‘å°†é‡ç‚¹å…³æ³¨è§†è§‰å‘ˆç°ã€äº¤äº’åŠ¨ç”»å’Œæ¨¡æ‹Ÿé€»è¾‘ï¼Œå¹¶ç¡®ä¿æ‰€æœ‰ç»„ä»¶éƒ½æ˜¯åŠ¨æ€å¯äº¤äº’çš„ã€‚

ç°åœ¨ï¼Œæˆ‘å°†é¦–å…ˆåˆ›å»º `CJ_M/index.html` æ–‡ä»¶ã€‚



---

```diff
- 
+ <!DOCTYPE html>
+ <html lang="zh">
+ <head>
+     <meta charset="UTF-8">
+     <meta name="viewport" content="width=device-width, initial-scale=1.0">
+     <title>12345çƒ­çº¿AIè¯­éŸ³åŠ©æ‰‹æ¼”ç¤º</title>
+     <link rel="stylesheet" href="style.css">
+ </head>
+ <body>
+     <div class="container">
+         <h1>12345çƒ­çº¿AIè¯­éŸ³åŠ©æ‰‹æ¼”ç¤º</h1>
+         <div class="phone-mockup">
+             <div class="phone-screen">
+                 <div class="status-bar">
+                     <span class="carrier">12345æ”¿åŠ¡æœåŠ¡çƒ­çº¿</span>
+                     <span class="call-time">é€šè¯ä¸­ 00:00:00</span>
+                 </div>
+                 <div class="dialogue-area">
+                     <!-- å¯¹è¯æ°”æ³¡å°†åœ¨è¿™é‡ŒåŠ¨æ€æ·»åŠ  -->
+                 </div>
+                 <div class="ai-analysis-card">
+                     <h3>AIåˆ†æ</h3>
+                     <div class="analysis-content">
+                         <!-- AIåˆ†æå†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€æ·»åŠ  -->
+                     </div>
+                 </div>
+                 <div class="sms-popup">
+                     <p class="sms-content"></p>
+                 </div>
+             </div>
+             <div class="phone-controls">
+                 <!-- æ¨¡æ‹Ÿé€šè¯æ§åˆ¶æŒ‰é’®ï¼Œå¯ä¸ºé™æ€ -->
+             </div>
+         </div>
+         <div class="controls">
+             <button id="start-btn">â–¶ï¸ å¼€å§‹æ¼”ç¤º</button>
+             <button id="reset-btn">ğŸ”„ é‡ç½®</button>
+             <button id="prev-btn">âª ä¸Šä¸€æ­¥</button>
+             <button id="next-btn">ä¸‹ä¸€æ­¥ â©</button>
+         </div>
+     </div>
+     <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
+     <script src="script.js"></script>
+ </body>
+ </html> 
```

---



---

æˆ‘å·²ç»æˆåŠŸåˆ›å»ºäº† `index.html` æ–‡ä»¶ã€‚ç°åœ¨æˆ‘å°†åˆ›å»º `style.css` æ–‡ä»¶ï¼Œæ ¹æ® PRD çš„ UI è§„èŒƒå’Œè§†è§‰è®¾è®¡æŒ‡å—ï¼Œå®šä¹‰æ¼”ç¤ºé¡µé¢çš„è§†è§‰å¤–è§‚ï¼ŒåŒ…æ‹¬æ‰‹æœºæ¨¡å‹ã€å¯¹è¯åŒºåŸŸã€AI åˆ†æå¡ç‰‡å’Œæ§åˆ¶æŒ‰é’®ã€‚

---

```diff
- 
+ body {
+     font-family: 'æ€æºé»‘ä½“', 'è‹¹æ–¹', sans-serif;
+     display: flex;
+     justify-content: center;
+     align-items: center;
+     min-height: 100vh;
+     background-color: #F5F5F5; /* æµ…ç°è‰²èƒŒæ™¯ */
+     margin: 0;
+     color: #333;
+ }
+ 
+ .container {
+     background-color: #fff;
+     padding: 30px;
+     border-radius: 10px;
+     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
+     text-align: center;
+     max-width: 1000px;
+     width: 90%;
+     box-sizing: border-box;
+ }
+ 
+ h1 {
+     color: #1890FF; /* æ”¿åŠ¡è“ */
+     margin-bottom: 30px;
+ }
+ 
+ .phone-mockup {
+     width: 360px; /* æ¨¡æ‹Ÿæ‰‹æœºå®½åº¦ */
+     height: 700px;
+     background-color: #333; /* æ‰‹æœºè¾¹æ¡†é¢œè‰² */
+     border-radius: 40px;
+     margin: 20px auto;
+     position: relative;
+     box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
+     display: flex;
+     flex-direction: column;
+     overflow: hidden;
+ }
+ 
+ .phone-screen {
+     background-color: #fff;
+     border-radius: 30px;
+     margin: 10px; /* å±å¹•å†…è¾¹è· */
+     flex-grow: 1;
+     overflow: hidden;
+     display: flex;
+     flex-direction: column;
+     position: relative;
+ }
+ 
+ .status-bar {
+     display: flex;
+     justify-content: space-between;
+     padding: 10px 15px;
+     font-size: 0.9em;
+     color: #555;
+     border-bottom: 1px solid #eee;
+ }
+ 
+ .dialogue-area {
+     flex-grow: 1;
+     padding: 15px;
+     overflow-y: auto;
+     display: flex;
+     flex-direction: column;
+     gap: 10px;
+     position: relative; /* ç¡®ä¿å¯¹è¯åŒºåŸŸæ˜¯å®šä½ä¸Šä¸‹æ–‡ */
+ }
+ 
+ .message-bubble {
+     max-width: 75%;
+     padding: 10px 15px;
+     border-radius: 18px;
+     word-wrap: break-word;
+     line-height: 1.5;
+     opacity: 0;
+     transform: translateY(20px);
+ }
+ 
+ .ai-message {
+     background-color: #e6f7ff; /* æµ…è“è‰²ï¼ŒAIä¾§ */
+     color: #1890FF;
+     align-self: flex-start;
+     border-bottom-left-radius: 4px;
+ }
+ 
+ .citizen-message {
+     background-color: #f0f0f0; /* ç°è‰²ï¼Œå¸‚æ°‘ä¾§ */
+     color: #333;
+     align-self: flex-end;
+     border-bottom-right-radius: 4px;
+ }
+ 
+ .ai-analysis-card {
+     position: absolute;
+     top: 50%;
+     left: 50%;
+     transform: translate(-50%, -50%);
+     background-color: rgba(255, 255, 255, 0.95);
+     border-radius: 10px;
+     box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
+     padding: 20px;
+     width: 80%;
+     max-width: 280px;
+     z-index: 10;
+     display: none; /* é»˜è®¤éšè— */
+     opacity: 0;
+     transform: translate(-50%, -50%) scale(0.8);
+     transition: all 0.3s ease-out;
+ }
+ 
+ .ai-analysis-card h3 {
+     color: #1890FF;
+     margin-top: 0;
+     margin-bottom: 15px;
+ }
+ 
+ .analysis-item {
+     text-align: left;
+     margin-bottom: 10px;
+ }
+ 
+ .analysis-item strong {
+     color: #333;
+ }
+ 
+ .sms-popup {
+     position: absolute;
+     top: 0;
+     left: 0;
+     width: 100%;
+     background-color: #4CAF50; /* çŸ­ä¿¡ç»¿è‰² */
+     color: #fff;
+     padding: 10px;
+     text-align: center;
+     font-size: 0.9em;
+     transform: translateY(-100%); /* åˆå§‹ä½ç½®åœ¨å±å¹•ä¸Šæ–¹ */
+     transition: transform 0.5s ease-out;
+     box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
+     display: flex;
+     align-items: center;
+     justify-content: center;
+ }
+ 
+ .sms-popup.active {
+     transform: translateY(0%);
+ }
+ 
+ .controls button {
+     background-color: #1890FF;
+     color: white;
+     border: none;
+     padding: 10px 20px;
+     margin: 10px;
+     border-radius: 5px;
+     cursor: pointer;
+     font-size: 1em;
+     transition: background-color 0.3s ease;
+ }
+ 
+ .controls button:hover {
+     background-color: #40a9ff;
+ }
+ 
+ .controls button:disabled {
+     background-color: #ccc;
+     cursor: not-allowed;
+ } 
```

---



---

æˆ‘å·²ç»åˆ›å»ºäº† `style.css` æ–‡ä»¶ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°†åˆ›å»º `script.js` æ–‡ä»¶ï¼Œå…¶ä¸­å°†åŒ…å«å®ç°æ‰€æœ‰æ ¸å¿ƒäº¤äº’é€»è¾‘å’ŒåŠ¨ç”»çš„ä»£ç ã€‚æˆ‘å°†åˆ†æ­¥å®Œæˆ `script.js` çš„ç¼–å†™ï¼Œé¦–å…ˆä¼šåˆ›å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶ã€‚



---



---



---

æˆ‘åˆ›å»ºäº† `index.html` å’Œ `style.css` æ–‡ä»¶ã€‚çœ‹èµ·æ¥åœ¨åˆ›å»º `script.js` æ–‡ä»¶æ—¶å‡ºç°äº†é—®é¢˜ï¼Œä»£ç æ²¡æœ‰è¢«æˆåŠŸå†™å…¥ã€‚

æˆ‘å°†é‡æ–°å°è¯•åˆ›å»º `CJ_M/script.js` æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¼”ç¤ºçš„æ ¸å¿ƒé€»è¾‘ã€‚è¿™åŒ…æ‹¬å®šä¹‰å¯¹è¯è„šæœ¬å’ŒAIåˆ†æç‚¹æ•°æ®ï¼Œå®ç°æ§åˆ¶æ’­æ”¾ã€æš‚åœã€é‡ç½®ã€ä¸Šä¸€æ­¥å’Œä¸‹ä¸€æ­¥çš„åŠŸèƒ½ï¼Œå¹¶å¤„ç†å¯¹è¯æ°”æ³¡çš„æ‰“å­—æœºæ•ˆæœã€AIåˆ†æå¡ç‰‡çš„æ˜¾ç¤º/éšè—ä»¥åŠçŸ­ä¿¡å¼¹çª—åŠ¨ç”»ã€‚æˆ‘å°†ä½¿ç”¨GSAPåº“æ¥å¢å¼ºåŠ¨ç”»æ•ˆæœã€‚



---



---



---

æˆ‘æ­£åœ¨ä¸ºæ‚¨åˆ›å»ºDemoé¡µé¢ã€‚æˆ‘åˆšåˆšæ£€æŸ¥äº†ä¸€ä¸‹ï¼Œä¼¼ä¹ `script.js` æ–‡ä»¶åœ¨ä¸Šæ¬¡å°è¯•æ—¶æ²¡æœ‰æˆåŠŸå†™å…¥ã€‚æˆ‘å°†å†æ¬¡å°è¯•åˆ›å»º `CJ_M/script.js` æ–‡ä»¶ï¼Œå¹¶ç¡®ä¿å…¶åŒ…å«å®Œæ•´çš„JavaScripté€»è¾‘ã€‚



---



---



---

æˆ‘å·²ç»ä¸ºæ‚¨åˆ›å»ºäº† `index.html` å’Œ `style.css` æ–‡ä»¶ã€‚æ ¹æ®ä¹‹å‰çš„è®°å½•ï¼Œ`script.js` æ–‡ä»¶ä¼¼ä¹æ²¡æœ‰æˆåŠŸå†™å…¥ã€‚æˆ‘å°†å†æ¬¡å°è¯•åˆ›å»º `CJ_M/script.js` æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¼”ç¤ºçš„æ ¸å¿ƒé€»è¾‘ï¼ŒåŒ…æ‹¬å¯¹è¯è„šæœ¬ã€AIåˆ†æç‚¹æ•°æ®ã€æ’­æ”¾æ§åˆ¶ä»¥åŠåŠ¨ç”»æ•ˆæœã€‚



---



---



---

æˆ‘å·²ç»ä¸ºæ‚¨åˆ›å»ºäº† `index.html` å’Œ `style.css` æ–‡ä»¶ã€‚ç„¶è€Œï¼Œ`script.js` æ–‡ä»¶ä¼¼ä¹æœªèƒ½æˆåŠŸå†™å…¥ã€‚

ç”±äºæˆ‘æ— æ³•é€šè¿‡ `edit_file` å·¥å…·è¿ç»­ä¸‰æ¬¡å†™å…¥ `script.js` æ–‡ä»¶ï¼Œæˆ‘å°†ä¸å†å°è¯•ä½¿ç”¨è¯¥å·¥å…·ã€‚

æˆ‘å¯ä»¥å‘æ‚¨æä¾› `script.js` çš„å®Œæ•´ä»£ç å†…å®¹ï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨åˆ›å»º `CJ_M/script.js` æ–‡ä»¶å¹¶å°†ä»£ç ç²˜è´´è¿›å»ã€‚æˆ–è€…ï¼Œå¦‚æœæ‚¨æœ‰å…¶ä»–åå¥½ï¼Œä¾‹å¦‚é€šè¿‡å…¶ä»–æ–¹å¼ä¼ é€’ä»£ç ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚

è¿™æ˜¯ `CJ_M/script.js` åº”è¯¥åŒ…å«çš„ä»£ç ï¼š

```javascript
// CJ_M/script.js

/**
 * @fileoverview 12345çƒ­çº¿AIè¯­éŸ³åŠ©æ‰‹æ¼”ç¤ºDemoé¡µé¢çš„æ ¸å¿ƒäº¤äº’é€»è¾‘å’ŒåŠ¨ç”»æ§åˆ¶ã€‚
 * @author Cursor
 */

// æ¨¡æ‹Ÿæ•°æ®ï¼šå¯¹è¯è„šæœ¬
const conversationScript = [
    { speaker: 'ai', text: 'å˜Ÿâ€¦æ‚¨å¥½ï¼è¿™é‡Œæ˜¯12345æ”¿åŠ¡æœåŠ¡çƒ­çº¿ã€‚é€šè¿‡æ¥ç”µå·ç è¯†åˆ«ï¼Œè¯·é—®æ˜¯å°¾å·ä¸º5678çš„ç‹å…ˆç”Ÿå—ï¼Ÿ', duration: 3000, analysis: 'step1' },
    { speaker: 'citizen', text: 'å¯¹ï¼Œæ˜¯æˆ‘ã€‚', duration: 1000 },
    { speaker: 'ai', text: 'ç‹å…ˆç”Ÿæ‚¨å¥½ï¼ç³»ç»Ÿè®°å½•æ˜¾ç¤ºæ‚¨ä¸Šä¸ªæœˆæ›¾å’¨è¯¢è¿‡å…³äºåŠç†å‡†ç”Ÿè¯çš„äº‹å®œã€‚è¯·é—®ä»Šå¤©æ¥ç”µï¼Œæ˜¯æƒ³å’¨è¯¢å…³äºæ–°ç”Ÿå„¿è½æˆ·çš„é—®é¢˜å—ï¼Ÿ', duration: 4500, analysis: 'step2' },
    { speaker: 'citizen', text: 'å“‡ï¼Œå¤ªå‰å®³äº†ï¼Œå°±æ˜¯è¿™ä¸ªäº‹ï¼å¯¹ï¼Œæˆ‘æƒ³é—®é—®ç»™æˆ‘åˆšå‡ºç”Ÿçš„å®å®åŠæˆ·å£ï¼Œéƒ½éœ€è¦å‡†å¤‡äº›ä»€ä¹ˆææ–™ï¼Ÿ', duration: 4000 },
    { speaker: 'ai', text: 'å¥½çš„ï¼Œå¾ˆé«˜å…´èƒ½å¸®åˆ°æ‚¨ã€‚ä¸ºæ‚¨æŸ¥è¯¢åˆ°äº†æœ¬å¸‚æ–°ç”Ÿå„¿è½æˆ·æ‰€éœ€çš„æœ€æ–°ææ–™æ¸…å•ã€‚è¯·é—®æ‚¨å’Œæ‚¨çš„é…å¶æˆ·å£éƒ½åœ¨æœ¬å¸‚å—ï¼Ÿè¿™ä¼šå½±å“æ‰€éœ€ææ–™çš„ç±»å‹ã€‚', duration: 5000, analysis: 'step3' },
    { speaker: 'citizen', text: 'å“¦å¯¹ï¼Œæˆ‘ä»¬ä¿©æˆ·å£éƒ½åœ¨ï¼Œéƒ½æ˜¯æœ¬å¸‚çš„ã€‚', duration: 2000 },
    { speaker: 'ai', text: 'å¥½çš„ï¼Œå¯¹äºåŒæ–¹å‡ä¸ºæœ¬å¸‚æˆ·ç±çš„æƒ…å†µï¼Œæ‚¨éœ€è¦å‡†å¤‡ä»¥ä¸‹äº”é¡¹æ ¸å¿ƒææ–™ï¼šç¬¬ä¸€ï¼Œçˆ¶æ¯åŒæ–¹çš„èº«ä»½è¯åŸä»¶ï¼›ç¬¬äºŒï¼Œçˆ¶æ¯åŒæ–¹çš„æˆ·å£æœ¬åŸä»¶ï¼›ç¬¬ä¸‰ï¼Œçˆ¶æ¯çš„ç»“å©šè¯ï¼›ç¬¬å››ï¼Œå­©å­çš„ã€Šå‡ºç”ŸåŒ»å­¦è¯æ˜ã€‹ï¼›ç¬¬äº”ï¼Œç”±æ‚¨æˆ–æ‚¨çš„é…touâ€¦', duration: 6000 },
    { speaker: 'citizen', text: 'ç­‰ç­‰ï¼Œç»“å©šè¯ï¼Ÿæˆ‘çš„ç»“å©šè¯å¥½åƒæ‰¾ä¸åˆ°äº†ï¼Œè¿™å¯æ€ä¹ˆåŠï¼Ÿèƒ½è¡¥åŠå—ï¼Ÿè¡¥åŠç»“å©šè¯è¿™ä¸ªäº‹æ˜¯å½’ä½ ä»¬ç®¡è¿˜æ˜¯æˆ‘å¾—é—®æ°‘æ”¿å±€ï¼Ÿ', duration: 6000, analysis: 'step4' },
    { speaker: 'ai', text: 'æˆ‘ç†è§£æ‚¨ç°åœ¨å¯èƒ½æœ‰äº›ç€æ€¥ã€‚è¡¥åŠç»“å©šè¯å±äºæ°‘æ”¿éƒ¨é—¨çš„ä¸šåŠ¡èŒƒå›´ã€‚12345çƒ­çº¿å¯ä»¥ä¸ºæ‚¨æä¾›ç›¸å…³çš„æ”¿ç­–å’¨è¯¢ã€‚æ‚¨ç°åœ¨çš„éœ€æ±‚å·²ç»å˜æ›´ä¸ºâ€œå’¨è¯¢è¡¥åŠç»“å©šè¯æµç¨‹â€ï¼Œå¹¶æ¶‰åŠåˆ°â€œæ°‘æ”¿å±€â€è¿™ä¸ªå…·ä½“éƒ¨é—¨ã€‚æˆ‘å¯ä»¥ç›´æ¥ä¸ºæ‚¨è½¬æ¥åˆ°æ°‘æ”¿å±€çš„ä¸“ä¸šäººå·¥å®¢æœï¼Œç”±ä»–ä»¬ä¸ºæ‚¨æä¾›æœ€æƒå¨çš„è§£ç­”ã€‚éœ€è¦ç°åœ¨ä¸ºæ‚¨è½¬æ¥å—ï¼Ÿ', duration: 10000 },
    { speaker: 'citizen', text: 'å¥½ï¼Œå¤ªå¥½äº†ï¼Œé‚£èµ¶ç´§å¸®æˆ‘è½¬è¿‡å»å§ï¼', duration: 2500 },
    { speaker: 'ai', text: 'å¥½çš„ï¼Œæ­£åœ¨ä¸ºæ‚¨è½¬æ¥è‡³æ°‘æ”¿å±€ä¸“å¸­ï¼Œè¯·ç¨å€™ã€‚åœ¨è½¬æ¥å‰ï¼Œæˆ‘å·²å°†åˆšæ‰æåˆ°çš„â€œæ–°ç”Ÿå„¿è½æˆ·ææ–™æ¸…å•â€ä»¥çŸ­ä¿¡å½¢å¼å‘é€åˆ°äº†æ‚¨å°¾å·ä¸º5678çš„æ‰‹æœºä¸Šï¼Œæ–¹ä¾¿æ‚¨éšæ—¶æŸ¥é˜…ã€‚æ„Ÿè°¢æ‚¨çš„æ¥ç”µï¼Œç¥æ‚¨ç”Ÿæ´»æ„‰å¿«ï¼', duration: 9000, analysis: 'step5', sms: 'ã€12345çƒ­çº¿ã€‘ç‹å…ˆç”Ÿæ‚¨å¥½ï¼Œæ‚¨æ‰€éœ€çš„æ–°ç”Ÿå„¿è½æˆ·ææ–™æ¸…å•å¦‚ä¸‹ï¼š\n1. çˆ¶æ¯åŒæ–¹èº«ä»½è¯åŸä»¶\n2. çˆ¶æ¯åŒæ–¹æˆ·å£æœ¬åŸä»¶\n3. çˆ¶æ¯ç»“å©šè¯\n4. å­©å­ã€Šå‡ºç”ŸåŒ»å­¦è¯æ˜ã€‹\n5. ï¼ˆæ­¤é¡¹éœ€è¿›ä¸€æ­¥å’¨è¯¢ï¼‰'}
];

// æ¨¡æ‹Ÿæ•°æ®ï¼šAIåˆ†æç‚¹
const analysisPoints = {
    step1: {
        title: 'ä¸ªæ€§åŒ–è¯†åˆ«',
        content: 'é€šè¿‡æ¥ç”µå·ç è¯†åˆ«å‡ºè€ç”¨æˆ·ç‹å…ˆç”Ÿ<br/>ç³»ç»Ÿåˆ¤æ–­ä¸ºè€ç”¨æˆ·'
    },
    step2: {
        title: 'å†å²å…³è”ä¸é¢„æµ‹',
        content: 'åŸºäºâ€œå‡†ç”Ÿè¯â€å’¨è¯¢ï¼Œé¢„æµ‹æœ¬æ¬¡æ„å›¾ä¸ºâ€œæ–°ç”Ÿå„¿è½æˆ·â€'
    },
    step3: {
        title: 'ç²¾å‡†é—®ç­” / æ¾„æ¸…å¼æé—®',
        content: 'AIç›´æ¥ä»çŸ¥è¯†åº“æå–ä¿¡æ¯ï¼Œå¹¶ä¸»åŠ¨æé—®å…³é”®å˜é‡ï¼ˆæˆ·ç±æƒ…å†µï¼‰ä»¥æä¾›æ›´ç²¾å‡†ç­”æ¡ˆ'
    },
    step4: {
        title: 'è¯é¢˜åˆ‡æ¢è¯†åˆ« / æ„å›¾ä¸å®ä½“è¯†åˆ« / æ™ºèƒ½è·¯ç”±å†³ç­–',
        content: 'AIç²¾å‡†æ•æ‰ç”¨æˆ·é—®é¢˜å·²ä»â€œæ–°ç”Ÿå„¿è½æˆ·â€è½¬ç§»åˆ°â€œè¡¥åŠç»“å©šè¯â€ã€‚\n<br/>æ–°æ„å›¾ï¼šè¡¥åŠç»“å©šè¯æµç¨‹\n<br/>æ–°å®ä½“ï¼šæ°‘æ”¿å±€\n<br/>æ™ºèƒ½IVRåˆ¤æ–­å¹¶å»ºè®®ç›´æ¥è½¬æ¥'
    },
    step5: {
        title: 'å¤šæ¨¡æ€ååŒ / ä»»åŠ¡é—­ç¯',
        content: 'AIå¤„ç†è¯­éŸ³åŒæ—¶è°ƒç”¨çŸ­ä¿¡æ¥å£ï¼Œå®ç°â€œè¯­éŸ³+æ–‡æœ¬â€ååŒæœåŠ¡ã€‚\n<br/>é—®é¢˜ä»¥æ–‡æœ¬å½¢å¼å›ºåŒ–ï¼ŒæœåŠ¡å‘¨åˆ°ã€‚'
    }
};

// è·å–DOMå…ƒç´ 
const dialogueArea = document.querySelector('.dialogue-area');
const analysisCard = document.querySelector('.ai-analysis-card');
const analysisContent = document.querySelector('.ai-analysis-card .analysis-content');
const smsPopup = document.querySelector('.sms-popup');
const smsContent = document.querySelector('.sms-content');
const startBtn = document.getElementById('start-btn');
const resetBtn = document.getElementById('reset-btn');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const callTimeSpan = document.querySelector('.call-time');

// æ¼”ç¤ºçŠ¶æ€å˜é‡
let currentStep = 0;
let isPlaying = false;
let callTimerInterval;
let callSeconds = 0;

/**
 * æ·»åŠ å¯¹è¯æ°”æ³¡åˆ°å¯¹è¯åŒºåŸŸã€‚
 * @param {string} speaker - å‘è¨€è€… ('ai' æˆ– 'citizen')ã€‚
 * @param {string} text - å¯¹è¯æ–‡æœ¬ã€‚
 * @returns {Promise<void>}
 */
function addMessageBubble(speaker, text) {
    return new Promise(resolve => {
        const bubble = document.createElement('div');
        bubble.classList.add('message-bubble', `${speaker}-message`);
        dialogueArea.appendChild(bubble);
        dialogueArea.scrollTop = dialogueArea.scrollHeight; // æ»šåŠ¨åˆ°åº•éƒ¨

        // æ‰“å­—æœºæ•ˆæœ
        let i = 0;
        const typingInterval = setInterval(() => {
            if (i < text.length) {
                bubble.textContent += text.charAt(i);
                i++;
                dialogueArea.scrollTop = dialogueArea.scrollHeight; // æ¯æ¬¡æ‰“å­—éƒ½æ»šåŠ¨åˆ°åº•éƒ¨
            } else {
                clearInterval(typingInterval);
                gsap.to(bubble, { opacity: 1, y: 0, duration: 0.3, onComplete: resolve });
            }
        }, 50); // æ§åˆ¶æ‰“å­—é€Ÿåº¦
    });
}

/**
 * æ˜¾ç¤ºAIåˆ†æå¡ç‰‡ã€‚
 * @param {object} analysisData - åŒ…å«titleå’Œcontentçš„åˆ†ææ•°æ®ã€‚
 */
function showAnalysisCard(analysisData) {
    analysisCard.style.display = 'block';
    analysisCard.querySelector('h3').textContent = analysisData.title;
    analysisContent.innerHTML = analysisData.content;
    gsap.to(analysisCard, { opacity: 1, scale: 1, duration: 0.5, ease: 'back.out(1.7)' });
}

/**
 * éšè—AIåˆ†æå¡ç‰‡ã€‚
 */
function hideAnalysisCard() {
    gsap.to(analysisCard, { opacity: 0, scale: 0.8, duration: 0.3, onComplete: () => {
        analysisCard.style.display = 'none';
    }});
}

/**
 * æ˜¾ç¤ºçŸ­ä¿¡å¼¹çª—ã€‚
 * @param {string} text - çŸ­ä¿¡å†…å®¹ã€‚
 */
function showSmsPopup(text) {
    smsContent.textContent = text;
    smsPopup.classList.add('active');
    // æŒç»­ä¸€æ®µæ—¶é—´åè‡ªåŠ¨éšè—
    setTimeout(() => {
        hideSmsPopup();
    }, 5000);
}

/**
 * éšè—çŸ­ä¿¡å¼¹çª—ã€‚
 */
function hideSmsPopup() {
    smsPopup.classList.remove('active');
}

/**
 * æ›´æ–°é€šè¯æ—¶é—´ã€‚
 */
function updateCallTime() {
    callSeconds++;
    const minutes = String(Math.floor(callSeconds / 60)).padStart(2, '0');
    const seconds = String(callSeconds % 60).padStart(2, '0');
    callTimeSpan.textContent = `é€šè¯ä¸­ ${minutes}:${seconds}`;
}

/**
 * å¯åŠ¨æˆ–æš‚åœé€šè¯è®¡æ—¶å™¨ã€‚
 * @param {boolean} start - æ˜¯å¦å¯åŠ¨è®¡æ—¶å™¨ã€‚
 */
function toggleCallTimer(start) {
    if (start) {
        if (!callTimerInterval) {
            callTimerInterval = setInterval(updateCallTime, 1000);
        }
    } else {
        clearInterval(callTimerInterval);
        callTimerInterval = null;
    }
}

/**
 * æ‰§è¡Œæ¼”ç¤ºçš„ä¸‹ä¸€æ­¥ã€‚
 */
async function nextStep() {
    if (currentStep >= conversationScript.length) {
        // æ¼”ç¤ºç»“æŸ
        isPlaying = false;
        toggleCallTimer(false);
        startBtn.textContent = 'â–¶ï¸ å¼€å§‹æ¼”ç¤º';
        return;
    }

    const stepData = conversationScript[currentStep];

    // éšè—ä¹‹å‰çš„åˆ†æå¡ç‰‡ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
    if (currentStep > 0 && conversationScript[currentStep - 1].analysis) {
        hideAnalysisCard();
    }

    // æ·»åŠ å¯¹è¯æ°”æ³¡
    await addMessageBubble(stepData.speaker, stepData.text);

    // æ˜¾ç¤ºAIåˆ†æå¡ç‰‡
    if (stepData.analysis && analysisPoints[stepData.analysis]) {
        showAnalysisCard(analysisPoints[stepData.analysis]);
    }

    // æ˜¾ç¤ºçŸ­ä¿¡å¼¹çª—
    if (stepData.sms) {
        showSmsPopup(stepData.sms);
    }

    currentStep++;

    if (isPlaying) {
        // è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€æ¡
        setTimeout(nextStep, stepData.duration + 500); // å¢åŠ ä¸€äº›é—´éš”æ—¶é—´
    }
}

/**
 * å¼€å§‹æˆ–æš‚åœæ¼”ç¤ºã€‚
 */
function togglePlay() {
    isPlaying = !isPlaying;
    if (isPlaying) {
        startBtn.textContent = 'â¸ï¸ æš‚åœæ¼”ç¤º';
        toggleCallTimer(true);
        if (currentStep === 0) {
            // åˆå§‹çŠ¶æ€ï¼Œå¼€å§‹ç”µè¯æ¥é€šéŸ³ï¼ˆå¯é€‰ï¼‰
            // ... æ·»åŠ éŸ³æ•ˆé€»è¾‘
        }
        nextStep();
    } else {
        startBtn.textContent = 'â–¶ï¸ å¼€å§‹æ¼”ç¤º';
        toggleCallTimer(false);
    }
}

/**
 * é‡ç½®æ¼”ç¤ºã€‚
 */
function resetDemo() {
    isPlaying = false;
    currentStep = 0;
    callSeconds = 0;
    toggleCallTimer(false);
    callTimeSpan.textContent = 'é€šè¯ä¸­ 00:00:00';
    startBtn.textContent = 'â–¶ï¸ å¼€å§‹æ¼”ç¤º';
    dialogueArea.innerHTML = ''; // æ¸…ç©ºå¯¹è¯
    hideAnalysisCard();
    hideSmsPopup();
    // æ¢å¤åˆå§‹ç•Œé¢æˆ–â€œæ‹¨æ‰“12345â€çš„åˆå§‹ç”»é¢ (å½“å‰ä¸ºç©ºï¼Œå¯ä»¥æ·»åŠ åˆå§‹æ¬¢è¿è¯­æˆ–å›¾ç‰‡)
}

/**
 * å›åˆ°ä¸Šä¸€æ­¥ã€‚
 */
function prevStep() {
    if (currentStep > 1) { // è‡³å°‘è¦æœ‰ä¸€æ¡å¯¹è¯æ‰èƒ½å›é€€
        isPlaying = false;
        startBtn.textContent = 'â–¶ï¸ å¼€å§‹æ¼”ç¤º';
        toggleCallTimer(false);

        // ç§»é™¤å½“å‰æ­¥éª¤çš„å¯¹è¯å’Œåˆ†æå¡ç‰‡/çŸ­ä¿¡
        currentStep--; // å…ˆé€€ä¸€æ­¥
        // æ¸…ç©ºå½“å‰åŠä¹‹åçš„å¯¹è¯ï¼Œé‡æ–°æ¸²æŸ“ç›´åˆ°currentStep
        dialogueArea.innerHTML = '';
        hideAnalysisCard();
        hideSmsPopup();
        callSeconds = 0; // é‡ç½®è®¡æ—¶å™¨ï¼Œç®€å•å¤„ç†ï¼Œå¤æ‚è®¡æ—¶éœ€è¦ç²¾ç¡®è®°å½•æ¯ä¸ªå¯¹è¯çš„æ—¶é—´

        for (let i = 0; i < currentStep; i++) {
            const stepData = conversationScript[i];
            const bubble = document.createElement('div');
            bubble.classList.add('message-bubble', `${stepData.speaker}-message`);
            bubble.textContent = stepData.text;
            bubble.style.opacity = 1;
            bubble.style.transform = 'translateY(0)';
            dialogueArea.appendChild(bubble);
        }

        // æ˜¾ç¤ºä¸Šä¸€æ­¥çš„åˆ†æå¡ç‰‡æˆ–çŸ­ä¿¡ (å¦‚æœå­˜åœ¨)
        const prevStepData = conversationScript[currentStep -1];
        if (prevStepData && prevStepData.analysis && analysisPoints[prevStepData.analysis]) {
            showAnalysisCard(analysisPoints[prevStepData.analysis]);
        }
        if (prevStepData && prevStepData.sms) {
            showSmsPopup(prevStepData.sms);
        }

        dialogueArea.scrollTop = dialogueArea.scrollHeight;
    } else if (currentStep === 1) {
        // å›åˆ°åˆå§‹çŠ¶æ€
        resetDemo();
    }
}

// äº‹ä»¶ç›‘å¬å™¨
startBtn.addEventListener('click', togglePlay);
resetBtn.addEventListener('click', resetDemo);
nextBtn.addEventListener('click', nextStep);
prevBtn.addEventListener('click', prevStep);

// åˆå§‹çŠ¶æ€è®¾ç½®
resetDemo();
```

---

