<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>12345热线AI舆情分析Demo</title>
    <!-- 引入 ECharts 库 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
    <!-- 如果需要词云图，需要引入词云图扩展 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js"></script>
    <!-- 如果需要地图，需要引入地图数据文件，例如中国的地图数据 -->
    <!-- 注意：这里以中国地图为例，如果需要更细致的区域，需要对应的 geojson 或 js 文件 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/map/js/china.js"></script> -->
    <style>
        /* 5.2 视觉规范 */
        :root {
            --primary-color: #1E3A8A; /* 深蓝色 */
            --secondary-color: #3B82F6; /* 浅蓝色 */
            --warning-color: #F59E0B; /* 橙色 */
            --danger-color: #EF4444; /* 红色 */
            --success-color: #10B981; /* 绿色 */
            --background-color: #F8FAFC; /* 浅灰色 */
            --spacing-base: 8px; /* 基础间距 */
            --card-padding: 24px; /* 卡片内边距 */
            --component-spacing: 16px; /* 组件间距 */
        }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: #333;
        }

        .header {
            background-color: #fff;
            padding: var(--spacing-base) calc(var(--spacing-base) * 3);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header .logo {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .header .nav {
            display: flex;
            gap: calc(var(--spacing-base) * 3);
        }

        .header .nav a {
            text-decoration: none;
            color: #555;
            font-size: 14px;
            padding: var(--spacing-base) 0;
            border-bottom: 2px solid transparent;
            transition: border-bottom 0.3s ease;
        }

        .header .nav a:hover {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .container {
            padding: calc(var(--spacing-base) * 3);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--component-spacing);
            margin-bottom: calc(var(--spacing-base) * 3);
        }

        .card {
            background-color: #fff;
            padding: var(--card-padding);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
        }

        .card h3 {
            margin-top: 0;
            font-size: 16px;
            color: #666;
        }

        .card .value {
            font-size: 24px;
            font-weight: bold;
            margin-top: var(--spacing-base);
            color: var(--primary-color);
        }

        .chart-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--component-spacing);
            margin-bottom: calc(var(--spacing-base) * 3);
        }

        .chart-container {
            background-color: #fff;
            padding: var(--card-padding);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            min-height: 300px; /* Placeholder height */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            color: #999;
        }

        /* 响应式设计基础 */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: var(--spacing-base);
            }
            .header .nav {
                flex-direction: column;
                align-items: center;
                gap: var(--spacing-base);
            }
            .container {
                padding: var(--spacing-base);
            }
            .dashboard-grid, .chart-section {
                grid-template-columns: 1fr;
            }
        }

    </style>
</head>
<body>
    <header class="header">
        <div class="logo">12345热线AI舆情分析Demo</div>
        <nav class="nav">
            <a href="#">首页仪表板</a>
            <a href="#">实时监控</a>
            <a href="#">舆情分析</a>
            <a href="#">预警中心</a>
            <a href="#">报告中心</a>
        </nav>
    </header>

    <main class="container">
        <h1>首页仪表板</h1>

        <!-- 顶部统计卡片区域 -->
        <div class="dashboard-grid">
            <div class="card">
                <h3>今日来电总量</h3>
                <div class="value" id="total-calls">-</div>
            </div>
            <div class="card">
                <h3>热点问题数量</h3>
                <div class="value" id="hot-topics">-</div>
            </div>
            <div class="card">
                <h3>预警事件数量</h3>
                <div class="value" id="alerts">-</div>
            </div>
            <div class="card">
                <h3>处理完成率</h3>
                <div class="value" id="completion-rate">-</div>
            </div>
        </div>

        <!-- 中部/底部核心展示区域 - 占位 -->
        <div class="chart-section">
            <div class="chart-container" id="realtime-calls-heatmap">实时来电热力图占位</div>
            <div class="chart-container" id="hot-topics-wordcloud">热点问题词云占位</div>
        </div>

        <div class="chart-section">
            <div class="chart-container" id="calls-trend-chart">来电趋势图占位</div>
            <div class="chart-container" id="category-distribution-chart">问题分类占比图占位</div>
            <!-- <div class="chart-container" id="region-distribution-chart">地区分布图占位</div> -->
        </div>

    </main>

    <script>
        // 模拟数据结构 (参考 PRD 7. 数据需求)
        /**
         * @typedef {object} CallRecord
         * @property {string} id
         * @property {string} timestamp - ISO 8601 datetime string
         * @property {string} content
         * @property {string} category
         * @property {string} subcategory
         * @property {string} district
         * @property {'positive'|'neutral'|'negative'} sentiment
         * @property {'high'|'medium'|'low'} urgency
         * @property {string[]} keywords
         * @property {'pending'|'processing'|'resolved'} status
         */

        /**
         * @typedef {object} StatsData
         * @property {string} date - YYYY-MM-DD string
         * @property {number} totalCalls
         * @property {{[key: string]: number}} categoryStats
         * @property {{positive: number, neutral: number, negative: number}} sentimentStats
         * @property {{[key: string]: number}} districtStats
         */

        /**
         * @typedef {object} AlertEvent
         * @property {string} id
         * @property {string} title
         * @property {string} description
         * @property {'high'|'medium'|'low'} riskLevel
         * @property {string} district
         * @property {number} relatedCalls
         * @property {string} createdTime - ISO 8601 datetime string
         * @property {'active'|'resolved'} status
         * @property {string[]} suggestions
         */


        // 模拟数据函数 (简化)
        /**
         * 模拟获取统计数据
         * @returns {Promise<StatsData>}
         */
        async function fetchMockStats() {
            // 模拟网络延迟
            await new Promise(resolve => setTimeout(resolve, 500));
            const mockData = {
                date: new Date().toISOString().split('T')[0],
                totalCalls: Math.floor(Math.random() * 1000) + 500,
                categoryStats: { "投诉": 300, "咨询": 450, "建议": 200, "求助": 50 },
                sentimentStats: { positive: 600, neutral: 300, negative: 100 },
                districtStats: { "东城区": 200, "西城区": 300, "海淀区": 400, "朝阳区": 250 }
            };
            return mockData;
        }

        /**
         * 模拟获取预警事件数据
         * @returns {Promise<AlertEvent[]>}
         */
        async function fetchMockAlerts() {
             // 模拟网络延迟
            await new Promise(resolve => setTimeout(resolve, 300));
            const mockAlerts = [
                { id: "alert-001", title: "某区域群体性事件苗头", description: "关于XX问题的投诉短期内激增", riskLevel: "high", district: "海淀区", relatedCalls: 55, createdTime: new Date().toISOString(), status: "active", suggestions: ["立即派人调查", "安抚群众情绪"] },
                { id: "alert-002", title: "XX政策解读不清导致大量咨询", description: "大量来电询问新出台的XX政策细节", riskLevel: "medium", district: "全市", relatedCalls: 120, createdTime: new Date().toISOString(), status: "active", suggestions: ["发布官方解读", "加强宣传力度"] }
            ];
            return mockAlerts;
        }


        // 更新仪表板数据 (占位)
        /**
         * 更新页面统计卡片数据
         */
        async function updateDashboardStats() {
            try {
                const stats = await fetchMockStats();
                document.getElementById('total-calls').innerText = stats.totalCalls;
                // 模拟热点问题和预警数量，实际应从后端获取
                document.getElementById('hot-topics').innerText = Object.keys(stats.categoryStats).length; // 简单模拟
                const alerts = await fetchMockAlerts();
                 document.getElementById('alerts').innerText = alerts.filter(a => a.status === 'active').length;
                // 模拟处理完成率
                document.getElementById('completion-rate').innerText = '85%'; // 静态值
            } catch (error) {
                console.error("Failed to fetch mock stats:", error);
                document.getElementById('total-calls').innerText = '加载失败';
                document.getElementById('hot-topics').innerText = '加载失败';
                document.getElementById('alerts').innerText = '加载失败';
                 document.getElementById('completion-rate').innerText = '加载失败';
            }
        }

        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', () => {
            console.log("Demo页面加载完成，开始模拟数据加载并初始化图表...");
            updateDashboardStats();
            updateCharts();

            // 模拟实时数据和图表更新 (每30秒)
            setInterval(() => {
                updateDashboardStats();
                updateCharts();
            }, 30000);
        });


        // 模拟图表数据生成函数
        /**
         * 模拟生成来电趋势数据
         * @returns {object}
         */
        function generateMockTrendData() {
            const labels = [];
            const data = [];
            const now = new Date();
            // 生成过去24小时的数据
            for (let i = 23; i >= 0; i--) {
                const hour = (now.getHours() - i + 24) % 24;
                labels.push(`${hour}:00`);
                data.push(Math.floor(Math.random() * 50) + 10);
            }
            return { labels, data };
        }

        /**
         * 模拟生成问题分类占比数据
         * @returns {object[]}
         */
        function generateMockCategoryData() {
            const categories = ["投诉", "咨询", "建议", "求助", "其他"];
            const data = categories.map(category => ({
                name: category,
                value: Math.floor(Math.random() * 200) + 50
            }));
            return data;
        }

        /**
         * 模拟生成热力图数据 (简化)
         * @returns {object[]}
         */
        function generateMockHeatmapData() {
             // 简单的二维数据，例如按小时和天分布
             const hours = Array.from({ length: 24 }, (_, i) => `${i}:00`);
             const days = ['周一', '周二', '周三', '周四', '周五', '周六', '周日'];
             const data = [];
             days.forEach((day, dayIndex) => {
                 hours.forEach((hour, hourIndex) => {
                     data.push([hourIndex, dayIndex, Math.floor(Math.random() * 100)]);
                 });
             });
             return { hours, days, data };
        }

         /**
          * 模拟生成词云数据 (简化)
          * @returns {object[]}
          */
         function generateMockWordcloudData() {
              const words = ['交通', '噪音', '环境卫生', '市政设施', '教育', '医疗', '就业', '社保', '房屋', '物业', '公共安全', '消费维权', '服务态度', '政策咨询', '建议', '投诉', '咨询', '求助'];
              const data = words.map(word => ({ name: word, value: Math.floor(Math.random() * 500) + 50 }));
              return data;
         }

        /**
         * 模拟生成地图数据 (占位，需要具体地图数据)
         * @returns {object[]}
         */
        /*
        function generateMockRegionData() {
            // 这里的name需要与地图数据中的区域名称匹配
            const regions = ['北京', '上海', '广州', '深圳', '杭州', '成都', '武汉', '重庆'];
            const data = regions.map(region => ({
                name: region,
                value: Math.floor(Math.random() * 1000) + 100
            }));
            return data;
        }
        */


        // ECharts 初始化和数据更新
        const realtimeCallsHeatmapChart = echarts.init(document.getElementById('realtime-calls-heatmap'));
        const hotTopicsWordcloudChart = echarts.init(document.getElementById('hot-topics-wordcloud')); // 注意：词云图可能需要额外的echarts-wordcloud.js库
        const callsTrendChart = echarts.init(document.getElementById('calls-trend-chart'));
        const categoryDistributionChart = echarts.init(document.getElementById('category-distribution-chart'));
        // const regionDistributionChart = echarts.init(document.getElementById('region-distribution-chart')); // 注意：地图需要额外的地图数据和echarts-geo/map组件

        /**
         * 更新所有图表数据
         */
        function updateCharts() {
            // 来电趋势图
            const trendData = generateMockTrendData();
            callsTrendChart.setOption({
                title: { text: '来电趋势图', left: 'center' },
                tooltip: { trigger: 'axis' },
                xAxis: { type: 'category', data: trendData.labels },
                yAxis: { type: 'value' },
                series: [{
                    name: '来电数量',
                    type: 'line',
                    smooth: true,
                    data: trendData.data
                }]
            });

            // 问题分类占比图
            const categoryData = generateMockCategoryData();
            categoryDistributionChart.setOption({
                title: { text: '问题分类占比图', left: 'center' },
                tooltip: { trigger: 'item' },
                 legend: { orient: 'vertical', left: 'left' },
                series: [
                    {
                        name: '问题分类',
                        type: 'pie',
                        radius: '50%',
                        data: categoryData,
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                ]
            });

             // 热力图 (基础配置)
             const heatmapData = generateMockHeatmapData();
             realtimeCallsHeatmapChart.setOption({
                 title: { text: '实时来电热力图', left: 'center' },
                 tooltip: { position: 'top' },
                 grid: { height: '50%', top: '10%' },
                 xAxis: { type: 'category', data: heatmapData.hours, splitArea: { show: true } },
                 yAxis: { type: 'category', data: heatmapData.days, splitArea: { show: true } },
                 visualMap: { min: 0, max: 100, calculable: true, orient: 'horizontal', left: 'center', bottom: 'bottom' },
                 series: [{
                     name: '来电密度',
                     type: 'heatmap',
                     data: heatmapData.data,
                     label: { show: false }, // 默认不显示数值，可按需开启
                     emphasis: { itemStyle: { shadowBlur: 10, shadowColor: 'rgba(0, 0, 0, 0.5)' } }
                 }]
             });

             // 词云图 (基础配置)
             const wordcloudData = generateMockWordcloudData();
             hotTopicsWordcloudChart.setOption({
                 title: { text: '热点问题词云', left: 'center' },
                  tooltip: { trigger: 'item' },
                  series: [{
                      type: 'wordCloud',
                      shape: 'circle',
                      left: 'center',
                      top: 'center',
                      width: '90%',
                      height: '90%',
                      right: null,
                      bottom: null,
                      sizeRange: [12, 60],
                      rotationRange: [-90, 90],
                      rotationStep: 45,
                      gridSize: 8,
                      drawOutOfBound: false,
                      shrinkToFit: false,
                      textStyle: {
                          color: function () {
                              return 'rgb(' + [
                                  Math.round(Math.random() * 160),
                                  Math.round(Math.random() * 160),
                                  Math.round(Math.random() * 160)
                              ].join(',') + ')';
                          },
                          emphasis: { shadowBlur: 10, shadowColor: '#333' }
                      },
                      data: wordcloudData
                  }]
              });

             // 地区分布图 (占位配置，需要地图数据和注册)
             /*
             const regionData = generateMockRegionData();
             regionDistributionChart.setOption({
                  title: { text: '地区分布图 (需地图数据)', left: 'center' },
                  tooltip: { trigger: 'item' },
                  visualMap: { min: 100, max: 1100, left: 'left', top: 'bottom', text: ['High','Low'], calculable: true },
                  geo: {
                      map: 'china', // 'china' 需要 echarts-map/js/china.js
                      roam: true,
                      label: { show: true },
                      itemStyle: { areaColor: '#e0e0e0', borderColor: '#fff' },
                      emphasis: { itemStyle: { areaColor: '#b3b3b3' } }
                  },
                  series: [
                      {
                          name: '来电数量',
                          type: 'map',
                          geoIndex: 0,
                          data: regionData
                      }
                  ]
              });
             */
        }

    </script>

    <!-- 引入 ECharts 库 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script> -->
    <!-- 如果需要词云图，需要引入词云图扩展 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js"></script> -->
    <!-- 如果需要地图，需要引入地图数据文件，例如中国的地图数据 -->
    <!-- 注意：这里以中国地图为例，如果需要更细致的区域，需要对应的 geojson 或 js 文件 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/map/js/china.js"></script> -->
</body>
</html>
